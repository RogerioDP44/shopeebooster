async function acionarIA(nome, preco) {
    const tituloDiv = document.getElementById('resTitulo');
    const descDiv = document.getElementById('resDescricao');
    const tagsDiv = document.getElementById('resTags');

    tituloDiv.innerText = "GERANDO TÍTULO... ⏳";
    descDiv.innerText = "CRIANDO DESCRIÇÃO... ✨";
    tagsDiv.innerText = "...";

    try {
        const response = await fetch('/api/gerarTexto', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nome, preco })
        });

        if (!response.ok) throw new Error('Falha na API');

        const textoCompleto = await response.json();
        
        // Separa o conteúdo pelo marcador ###
        let partes = textoCompleto.split('###').map(p => p.trim());

        if (partes.length >= 3) {
            // Renderiza o Título (Sem Emojis) e Botão
            tituloDiv.innerHTML = `
                <div class="flex justify-between items-start">
                    <span class="flex-1">${partes[0].toUpperCase()}</span>
                    <button onclick="copiarTexto('${partes[0].toUpperCase()}')" class="ml-2 bg-orange-600 hover:bg-orange-700 text-[10px] text-white px-3 py-1 rounded-lg transition-colors">COPIAR</button>
                </div>`;
            
            // Renderiza a Descrição e Botão
            descDiv.innerHTML = `
                <div class="whitespace-pre-line">${partes[1]}</div>
                <button onclick="copiarTexto(\`${partes[1]}\`)" class="mt-4 bg-gray-800 hover:bg-black text-[10px] text-white px-3 py-2 rounded-lg w-full transition-colors">COPIAR DESCRIÇÃO COMPLETA</button>`;
            
            // Renderiza as Tags e Botão
            tagsDiv.innerHTML = `
                <div class="flex justify-between items-center">
                    <span class="text-orange-600">${partes[2]}</span>
                    <button onclick="copiarTexto('${partes[2]}')" class="ml-2 bg-gray-200 text-[10px] text-gray-700 px-3 py-1 rounded-lg">COPIAR #</button>
                </div>`;
        } else {
            descDiv.innerText = textoCompleto;
        }

    } catch (e) {
        tituloDiv.innerText = "ERRO AO GERAR ❌";
        descDiv.innerText = "Verifique a sua chave API nas configurações da Vercel.";
        console.error("Erro:", e);
    }
}

// Função Global de Cópia
function copiarTexto(texto) {
    navigator.clipboard.writeText(texto).then(() => {
        alert("Copiado para a área de transferência! ✅");
    }).catch(err => {
        console.error('Erro ao copiar: ', err);
    });
}